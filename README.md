# Trivy UI Dashboard

A web-based UI for visualizing and managing Trivy vulnerability scan results in Kubernetes clusters.

## Overview
Trivy UI provides a centralized dashboard for viewing vulnerability reports generated by the Trivy Operator in Kubernetes environments. It offers an intuitive interface to browse, search, and analyze security vulnerabilities detected in your container images.

## Screenshots

### Dashboard Overview
![Dashboard Overview](./trivy-dashboard/public/trivy-dashboard.png)
*Main dashboard showing vulnerability statistics and summary*

### Report Details
![Report Details](./trivy-dashboard/public/report-details.png)
*In-depth view of individual vulnerability reports*

*Now only support view of vulnerability reports, other reports will fallback to json*

---

## Quick Start with Docker Image

You can quickly run Trivy UI using the official Docker image:

```shell
docker pull locustbaby/trivy-ui:v0.0.2

docker run -d \
  -v /path/to/your/kubeconfigs:/kubeconfigs \
  -e KUBECONFIG_DIR=/kubeconfigs \
  -p 8080:8080 \
  locustbaby/trivy-ui:v0.0.2
```
- Replace `/path/to/your/kubeconfigs` with the directory containing your kubeconfig files (one per cluster).
- Access the dashboard at http://localhost:8080

---

## Run in Kubernetes
1. Create a ServiceAccount and ClusterRoleBinding (see Trivy Operator docs for details)


2. Mount your kubeconfig directory as a volume and deploy the Trivy UI application:

### Run into Kubernetes
1. Create a `ClusterRole`, `ServiceAccount` and `ClusterRoleBinding`
```shell
kubectl apply -f - <<EOF
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: trivy-ui
rules:
- apiGroups:
  - ""
  resources:
  - namespaces
  verbs:
  - get
  - list
- apiGroups:
  - aquasecurity.github.io
  resources:
  - clustercompliancereports
  - clusterconfigauditreports
  - clusterinfraassessmentreports
  - clusterrbacassessmentreports
  - clustersbomreports
  - clustervulnerabilityreports
  - configauditreports
  - exposedsecretreports
  - infraassessmentreports
  - rbacassessmentreports
  - sbomreports
  - vulnerabilityreports
  verbs:
  - get
  - list
EOF

kubectl apply -f - <<EOF
apiVersion: v1
kind: ServiceAccount
metadata:
  name: trivy-ui
EOF

kubectl apply -f - <<EOF
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: trivy-ui
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: trivy-ui
subjects:
  - kind: ServiceAccount
    name: trivy-ui
EOF
```

```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  labels:
    app: trivy-ui
  name: trivy-ui
spec:
  replicas: 1
  selector:
    matchLabels:
      app: trivy-ui
  template:
    metadata:
      labels:
        app: trivy-ui
    spec:
      serviceAccountName: trivy-ui
      containers:
      - name: trivy-ui
        image: <image>
        env:
        - name: STATIC_PATH
          value: trivy-dashboard/dist
        - name: KUBECONFIG_DIR
          value: /kubeconfigs
        ports:
        - containerPort: 8080
          name: http
          protocol: TCP
        resources:
          limits:
            memory: 64Mi
          requests:
            memory: 64Mi
        volumeMounts:
        - name: kubeconfigs
          mountPath: /kubeconfigs
      volumes:
      - name: kubeconfigs
        secret:
          secretName: kubeconfigs
      dnsPolicy: ClusterFirst
      restartPolicy: Always
```

3. Expose the service:

```yaml
apiVersion: v1
kind: Service
metadata:
  labels:
    app: trivy-ui
  name: trivy-ui
spec:
  ports:
  - name: http
    port: 80
    targetPort: 8080
  selector:
    app: trivy-ui
  type: ClusterIP
```

4. (Optional) Create an Ingress:

```yaml
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  labels:
    app: trivy-ui
  name: trivy-ui
spec:
  ingressClassName: nginx
  rules:
  - host: trivy-ui.example.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: trivy-ui
            port:
              number: 80
  tls:
  - hosts:
    - trivy-ui.example.com
    secretName: trivy-ui-tls
```

---

## Features
- **Multi-Cluster Support**: Manage and view reports from multiple Kubernetes clusters by mounting a directory of kubeconfig files
- **Dashboard View**: Overview of vulnerability statistics across namespaces and clusters
- **Detailed Reports**: In-depth analysis of vulnerabilities by severity
- **Search & Filter**: Quickly locate specific vulnerability reports
- **Caching**: Optimized performance with disk-persistent caching
- **Responsive Design**: Works on desktop and mobile devices

## Architecture
The application consists of two main components:

- **Frontend**: Vue 3 single-page application with Vite
- **Backend**: Go server that interfaces with the Kubernetes API (multi-cluster via kubeconfig directory)

```
trivy-ui/
├── go-server/         # Go backend application
│   ├── api/           # API handlers
│   └── kubernetes/    # Kubernetes client interface
└── trivy-dashboard/   # Vue 3 frontend
    └── src/           # Frontend source code
```

## Prerequisites
- Go 1.24+
- Node.js 16+
- Access to one or more Kubernetes clusters with Trivy Operator installed
- Each cluster's kubeconfig file (see below)

### Build from Source
1. Clone the repository
```shell
git clone https://github.com/locustbaby/trivy-ui.git
cd trivy-ui
```
2. Build and run the frontend
```shell
cd trivy-dashboard
npm install
npm run build
```
3. Build and run the backend server
```shell
cd ../go-server
go build
./go-server
```
4. Access the dashboard at http://localhost:8080


## Environment Variables
The server can be configured using the following environment variables:

| Variable         | Description                                 | Default           |
|------------------|---------------------------------------------|-------------------|
| PORT             | HTTP port to listen on                      | 8080              |
| DEBUG            | Enable debug logging                        | false             |
| STATIC_PATH      | Path to static frontend assets              | ../trivy-dashboard/dist |
| KUBECONFIG_DIR   | Directory containing kubeconfig files       | /kubeconfigs      |

## Development

### Backend (Go)
The backend server provides APIs for accessing Trivy vulnerability reports from multiple Kubernetes clusters.
```shell
cd go-server
go run main.go
```

### Frontend (Vue 3)
For frontend development with hot reload.
```shell
cd trivy-dashboard
npm run dev
```

## Contributing
Contributions are welcome! Please feel free to submit a Pull Request.

1. Fork the project
2. Create your feature branch (`git checkout -b feature/new-feature`)
3. Commit your changes (`git commit -m 'Add new feature'`)
4. Push to the branch (`git push origin feature/new-feature`)
5. Open a Pull Request

## License
This project is licensed under the MIT License - see the LICENSE file for details.

## Acknowledgments
- Trivy - The vulnerability scanner
- Trivy Operator - Kubernetes operator for Trivy
- Vue.js - Frontend framework
- Go - Backend language